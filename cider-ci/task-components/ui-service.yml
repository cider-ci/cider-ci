templates:
  ui_database:
    src: "user-interface/cider-ci/templates/database.yml"
    dest: "user-interface/config/database.yml"

scripts:
  ci-ui_setup-ruby:
    exclusive_executor_resource: ui-ruby
    body: |
      #!/bin/bash
      set -euo pipefail
      cd $CIDER_CI_TEST_UI_DIR
      ./bin/env/ruby-setup
      bundle
  ci-ui_install-all-deps-and-tools:
    start_when:
      ci-ui_setup-ruby passed:
        script_key: ci-ui_setup-ruby
    body: exit 0


  ci-ui_check-database-config:
    start_when:
      ci-ui_install-all-deps-and-tools passed:
        script_key: ci-ui_install-all-deps-and-tools
    body: |
      #!/usr/bin/env bash
      set -eou pipefail
      test -f $CIDER_CI_TEST_UI_DIR/config/database.yml
      cat $CIDER_CI_TEST_UI_DIR/config/database.yml

